"use strict";(self.webpackChunkweb_app=self.webpackChunkweb_app||[]).push([[463],{23895:function(e,n,t){t.d(n,{c:function(){return l}});var i=t(74165),r=t(15861),o=t(85554),s=t(11210),a=function(e){return e?e.replace(/([A-Z])/g,"_$1").toLowerCase():"invalid string passed"},l=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(n,t,r,l,c,d){var u,m,f,p,h;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=[n,t].sort().join("."),m=u.toLowerCase()+c,f=[r,l].sort().join(" and "),p=s.K.getState().userChatRooms,h=!1,0===p.filter((function(e){return e.jid===m})).length&&(h=!0,o.ZP.createNewRoom(u.toLowerCase()),o.ZP.setOwner(u.toLowerCase()),o.ZP.roomConfig(u.toLowerCase(),{roomName:f}),o.ZP.subsribe(m),o.ZP.presenceInRoom(m),setTimeout((function(){o.ZP.sendInvite(a(n),m.toLowerCase(),a(t))}),1e3)),e.abrupt("return",{roomJid:m,roomName:f,isNewRoom:h});case 7:case"end":return e.stop()}}),e)})));return function(n,t,i,r,o,s){return e.apply(this,arguments)}}()},3463:function(e,n,t){t.r(n),t.d(n,{default:function(){return pe}});var i,r=t(72791),o=t(20803),s=t(1413),a=t(74165),l=t(15861),c=t(70885),d=t(50228),u=t(85554),m=t(11210),f=t(47409),p=t(91482),h=t(16263),x=t(45586),g=t(78703),v=t(31128),j=t(95178),y=t(64880),Z=t(13811),w=t(48928),b=t(58487),C=t(30199),k=t(17205),S=t(60788),N=t(8440),I=t(4565),D=t(81872),A=t(59911),R=t(52898),L=t(23895),M=t(57050),P=t(52791),J=t(21686),z=t(64558),K=t(68438),T=t(80184),E=function(e){var n=e.message,t=e.userJid,i=e.position,o=e.buttonSender,s=e.chooseDirectRoom,a=n.data.senderFirstName,l=n.data.senderLastName,d=n.data.senderJID,g=(0,y.k6)(),E=(0,r.useState)(),U=(0,c.Z)(E,2),_=U[0],F=U[1],W=(0,r.useState)(!1),B=(0,c.Z)(W,2),O=B[0],H=B[1],V=r.useState(null),Y=(0,c.Z)(V,2),$=Y[0],q=Y[1],G=(0,r.useState)("dialog"),Q=(0,c.Z)(G,2),X=Q[0],ee=Q[1],ne=(0,r.useState)(""),te=(0,c.Z)(ne,2),ie=te[0],re=te[1],oe=Boolean($),se=(0,r.useState)(1),ae=(0,c.Z)(se,2),le=ae[0],ce=ae[1],de=(0,m.K)((function(e){return e.balance})).filter((function(e){return!e.tokenType&&e.contractAddress.length>10})),ue=(0,m.K)((function(e){return e.user})),me=(0,r.useState)("incoming"),fe=(0,c.Z)(me,2),pe=fe[0],he=fe[1],xe=function(e){q(null),H(!0),ee(e)},ge=function(e){var t=Number(e||le);(0,f.tZ)("DPT",de[0].tokenName,t,n.data.senderWalletAddress).then((function(e){var i=de[0].tokenName===K.zl?K.w5:de[0].tokenName,r=ue.firstName+" "+ue.lastName,o=n.data.senderFirstName+" "+n.data.senderLastName,s="".concat(r," -> ").concat(le," ").concat(i," -> ").concat(o);u.ZP.sendSystemMessage(n.roomJID,ue.firstName,ue.lastName,ue.walletAddress,s,t,n.id),H(!1)})).catch((function(e){console.log(e),re("An error occurred during the coin transfer."),ee("error")}))},ve=function(e){"clarify"===e&&(re("Are you sure you want to block the user?"),ee("clarification")),"block"===e&&(u.ZP.blacklistUser(n.data.senderJID),u.ZP.getBlackList(),m.K.getState().removeAllInMessageHistory(n.data.senderJID),H(!1))};return(0,r.useEffect)((function(){n.data.quickReplies&&F(JSON.parse(n.data.quickReplies)),he(String(t).split("/")[0]===String(d).split("/")[0]?"outgoing":"incoming")}),[]),(0,T.jsxs)("div",{is:"Message",children:[i.separator?(0,T.jsx)(v.it,{children:i.separator}):null,(0,T.jsxs)(v.v0,{onContextMenu:"incoming"===pe?function(e){e.preventDefault(),xe("dialog")}:null,style:{marginBottom:"last"===i.type||"single"===i.type?15:null},model:{sender:a+" "+l,direction:pe,position:i.position},avatarPosition:String(t).split("/")[0]===String(d).split("/")[0]?"tr":"tl",avatarSpacer:"first"!==i.type&&"single"!==i.type,children:[("first"===i.type||"single"===i.type)&&(0,T.jsx)("img",{style:{borderRadius:"50%",boxSizing:"border-box",width:"42px",height:"42px",cursor:"pointer"},onClick:function(){return g.push("/profile/"+n.data.senderWalletAddress)},is:"Avatar",src:n.data.photoURL?n.data.photoURL:"https://icotar.com/initials/"+a+" "+l,onError:function(e){var n=e.currentTarget;n.onerror=null,n.src="https://icotar.com/initials/"+a+" "+l},alt:a}),(0,T.jsxs)(v.v0.CustomContent,{children:[("first"===i.type||"single"===i.type)&&(0,T.jsxs)("span",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,T.jsxs)("strong",{style:{cursor:"pointer"},onClick:function(){return g.push("/profile/"+n.data.senderWalletAddress)},children:[a," ",l,(0,T.jsx)("br",{})]}),String(t).split("/")[0]!==String(d).split("/")[0]?(0,T.jsx)(Z.Z,{"aria-label":"more",id:"long-button","aria-controls":oe?"long-menu":void 0,"aria-expanded":oe?"true":void 0,"aria-haspopup":"true",onClick:function(){return xe("dialog")},children:(0,T.jsx)(R.Z,{})}):null]}),n.data.isMediafile&&"image"===n.data.mimetype.split("/")[0]?(0,T.jsx)(w.Z,{sx:{maxWidth:200},children:(0,T.jsx)(b.Z,{onClick:function(){H(!0),ee("image")},children:(0,T.jsx)(C.Z,{style:{height:150,objectFit:"cover",objectPosition:"left"},component:"img",height:"150",image:n.data.location,alt:n.data.originalName})})}):null,n.data.isMediafile&&"application"===n.data.mimetype.split("/")[0]?(0,T.jsxs)("a",{target:"_blank",href:n.data.location,children:[(0,T.jsx)(v.v0.ImageContent,{src:n.data.locationPreview,alt:n.data.originalName,width:150}),n.data.mimetype.split("/")[1]]}):null,n.data.isMediafile&&"video"===n.data.mimetype.split("/")[0]?(0,T.jsxs)("video",{controls:!0,width:"200px",children:[(0,T.jsx)("source",{src:n.data.location,type:n.data.mimetype,title:n.data.originalName}),"Sorry, your browser doesn't support videos."]}):null,n.data.isMediafile&&"audio"===n.data.mimetype.split("/")[0]?(0,T.jsxs)("audio",{controls:!0,children:[(0,T.jsx)("source",{src:n.data.location,type:n.data.mimetype}),"Your browser does not support the audio element."]}):null,n.data.isMediafile?null:(0,T.jsxs)("div",{children:[(0,T.jsx)("span",{dangerouslySetInnerHTML:{__html:n.body.replace(/\b(https?\:\/\/\S+)/gm,'<a href="$1">$1</a>')}}),(0,T.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:5,minWidth:200,color:"incoming"===pe?"rgb(110, 169, 215)":"#c6e3fa",flexDirection:"incoming"===pe?"row":"row-reverse"},children:[(0,T.jsx)("div",{style:{fontSize:12},children:(0,j.Z)(new Date,new Date(n.date))>5?(0,p.Z)(new Date(n.date),"h:mm a"):(0,h.Z)((0,x.Z)(new Date(n.date),0),new Date,{addSuffix:!0})}),n.coinsInMessage>0?(0,T.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,T.jsx)("div",{style:{fontSize:12},children:null===n||void 0===n?void 0:n.coinsInMessage}),(0,T.jsx)("img",{src:M,style:{width:25,height:25},alt:"coin"})]}):null]})]})]})]}),_?(0,T.jsx)(P.Z,{sx:{"& button":{m:.5}},children:(0,T.jsx)("div",{style:{display:"flex",flexDirection:"column",width:"max-content",marginLeft:"45px"},children:_.map((function(e,n){return(0,T.jsx)(k.Z,{variant:"outlined",size:"small",onClick:function(){return o(e)},children:e.name},n)}))})}):null,(0,T.jsx)(S.Z,{open:O,onClose:function(){return H(!1)},maxWidth:"xl",children:(0,T.jsxs)(N.Z,{children:["error"===X?(0,T.jsx)("div",{children:ie}):null,"clarification"===X?(0,T.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[ie,(0,T.jsx)(k.Z,{onClick:function(){return ve("block")},variant:"outlined",size:"small",children:"To block list"})]}):null,"dialog"===X?(0,T.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,T.jsxs)("div",{children:["Reward"," ",(0,T.jsx)("strong",{children:n.data.senderFirstName+" "+n.data.senderLastName})," ","with coins"]}),(0,T.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",margin:"10px 0px 10px 0px"},children:[1,3,5,"x"].map((function(e){return(0,T.jsxs)("div",{style:{textAlign:"center",cursor:"pointer"},onClick:function(){"number"===typeof e?ge(e):ee("transfer")},children:[(0,T.jsx)("img",{src:M,style:{width:25,height:25},alt:"coin"}),(0,T.jsx)(I.Z,{sx:{fontWeight:"bold"},children:e})]},e)}))}),(0,T.jsx)(D.Z,{style:{margin:"10px"}}),(0,T.jsx)(k.Z,{onClick:function(){(0,L.c)(ue.walletAddress,n.data.senderWalletAddress,ue.firstName,n.data.senderFirstName,"@conference.dev.dxmpp.com",n.data.senderJID).then((function(e){if(e.isNewRoom){var n={jid:e.roomJid,name:e.roomName,room_background:"none",room_thumbnail:"none",users_cnt:"2",unreadMessages:0,composing:"",toUpdate:!0,description:""};m.K.getState().setNewUserChatRoom(n),s(e.roomJid)}else s(e.roomJid)})).catch((function(e){console.log("openPrivateRoom Error: ",e)}))},variant:"outlined",startIcon:(0,T.jsx)(J.Z,{}),children:"Direct message"}),(0,T.jsx)(D.Z,{style:{margin:"10px"}}),(0,T.jsx)(k.Z,{onClick:function(){return ve("clarify")},variant:"contained",startIcon:(0,T.jsx)(z.Z,{}),children:"Block this user"}),(0,T.jsx)(I.Z,{style:{textAlign:"center"},variant:"caption",display:"block",gutterBottom:!0,children:"Stop seeing this user."})]}):null,"transfer"===X?(0,T.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,T.jsx)(A.Z,{id:"standard-basic",type:"number",label:"Enter transfer amount",variant:"standard",onChange:function(e){return ce(Number(e.target.value))}}),(0,T.jsx)(k.Z,{style:{marginTop:10},onClick:function(){return ge()},variant:"outlined",size:"small",children:"Send coins"})]}):null,"image"===X?(0,T.jsx)("div",{children:(0,T.jsx)("img",{src:n.data.location,alt:n.data.originalName,style:{maxWidth:"100%"}})}):null]})})]})},U=function(e){var n=e.message;e.userJid;return(0,T.jsx)("div",{style:{textAlign:"center",color:"#6ea9d7",fontSize:".8em",boxSizing:"border-box",fontFamily:"Helvetica Neue,Segoe UI,Helvetica,Arial,sans-serif"},children:n.body},n.key)},_=t(74142),F=t(52797),W=t(40464),B=t(39571),O=t(96580),H=t(77248),V=t(18267),Y=t(4942),$=t(73763),q="/chat/",G=function(e){var n=e.room,t=e.name,i=e.chatId,r=e.setDirection,o=(0,y.k6)();return n?(0,T.jsx)(d.Z,{justifyContent:"center",alignItems:"center",style:{padding:"10px 0",maxWidth:170},children:(0,T.jsx)(k.Z,{onClick:function(){r(),o.push(q+n.roomJid+$.Ts)},children:t})}):(0,T.jsx)(d.Z,{justifyContent:"center",alignItems:"center",style:{padding:"10px 0"},children:(0,T.jsx)(k.Z,{disabled:!i,onClick:function(){r(),o.push(q+"none")},children:"Empty"})})},Q=t(91803),X=function(e){var n=e.room,t=e.direction,i=e.previousRoom,r=(0,y.k6)();return null!==n&&void 0!==n&&n.name?(0,T.jsxs)(d.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[(0,T.jsx)(I.Z,{sx:{fontWeight:"bold",fontSize:18},children:n.name}),(0,T.jsx)(I.Z,{children:n.description})]}):(0,T.jsxs)(d.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,T.jsxs)(d.Z,{sx:{alignItems:"center",display:"flex"},children:[(0,T.jsxs)(I.Z,{children:["This space is empty. You can build your own room here for"," ",(0,T.jsx)("b",{children:"120 "})]}),(0,T.jsx)("img",{src:M,style:{width:20,height:20},alt:"coin"})]}),(0,T.jsx)(k.Z,{onClick:function(){r.push("/newchat",{metaDirection:t,metaRoom:i})},children:"Create Meta Room"})]})},ee=t(84094),ne="north",te="west",ie="south",re="east",oe={north:"n",west:"w",south:"s",east:"e"},se=(i={},(0,Y.Z)(i,te,re),(0,Y.Z)(i,re,te),(0,Y.Z)(i,ie,ne),(0,Y.Z)(i,ne,ie),i),ae={name:"",description:"",ownerNavLinks:{west:null,east:null,north:null,south:null},ownerId:"",contractAddress:"",createdAt:new Date,_id:"",roomJid:"",updatedAt:new Date,userNavLinks:{west:null,east:null,north:null,south:null}},le={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",p:2,outline:"none"},ce=function(e){var n=e.chatId,t=e.open,i=e.onClose,o=(0,r.useState)(""),s=(0,c.Z)(o,2),p=s[0],h=s[1],x=(0,r.useState)(!1),g=(0,c.Z)(x,2),v=g[0],j=g[1],y=(0,r.useState)(),w=(0,c.Z)(y,2),b=w[0],C=w[1],k=(0,r.useState)(ae),S=(0,c.Z)(k,2),N=S[0],I=S[1],D=(0,m.K)((function(e){return e.user})),A=(0,_.Z)(),R=function(){var e=(0,l.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.prev=1,e.next=4,(0,f.Vy)().get("/room/getRoom/"+n);case 4:t=e.sent,I(t.data.result),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),I(ae),console.log(e.t0);case 12:j(!1);case 13:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}();(0,r.useEffect)((function(){n||I(ae),n&&R()}),[n]);var L=function(e,n,t){var i=(0,u.$I)(D.walletAddress),r=D.firstName+" "+D.lastName+" has joined <-",o=D.firstName+" "+D.lastName+" has left ->",s={senderFirstName:D.firstName,senderLastName:D.lastName,senderWalletAddress:D.walletAddress,isSystemMessage:!0,tokenAmount:0,receiverMessageId:"",mucname:e,photoURL:D.profileImage,roomJid:n,isReply:!1,mainMessageText:"",mainMessageId:"",mainMessageUserName:""};u.ZP.sendMessageStanza(i+$.yK,n,t?o:r,s)},M=function(){var e=(0,l.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,f.Vy)().post("/room/join/"+n,{});case 3:t=e.sent,console.log(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();if((0,r.useEffect)((function(){null!==b&&void 0!==b&&b.name&&L(b.name,b.roomJid+$.Ts,!0)}),[b]),(0,r.useEffect)((function(){N.name&&(L(N.name,N.roomJid+$.Ts,!1),M())}),[N]),!N.roomJid&&!p)return null;var P=function(e){var t,i,r,o,s=function(e){return se[e]}(p);return function(){var e,n,t,i,r,o,s,a;return!(null!==N&&void 0!==N&&null!==(e=N.ownerNavLinks)&&void 0!==e&&e.south)&&!(null!==N&&void 0!==N&&null!==(n=N.ownerNavLinks)&&void 0!==n&&n.east)&&!(null!==N&&void 0!==N&&null!==(t=N.ownerNavLinks)&&void 0!==t&&t.west)&&!(null!==N&&void 0!==N&&null!==(i=N.ownerNavLinks)&&void 0!==i&&i.north)&&!(null!==N&&void 0!==N&&null!==(r=N.userNavLinks)&&void 0!==r&&r.south)&&!(null!==N&&void 0!==N&&null!==(o=N.userNavLinks)&&void 0!==o&&o.east)&&!(null!==N&&void 0!==N&&null!==(s=N.userNavLinks)&&void 0!==s&&s.west)&&!(null!==N&&void 0!==N&&null!==(a=N.userNavLinks)&&void 0!==a&&a.north)}()&&e===s?(0,T.jsx)(G,{name:s+":"+(null===b||void 0===b?void 0:b.name),chatId:n,room:b,setDirection:function(){h(s),C(b)}}):(0,T.jsx)(G,{name:oe[e]+":"+((null===(t=N.ownerNavLinks[e])||void 0===t?void 0:t.name)||(null===(i=N.userNavLinks[e])||void 0===i?void 0:i.name)),chatId:n,room:(null===N||void 0===N||null===(r=N.ownerNavLinks)||void 0===r?void 0:r[e])||(null===N||void 0===N||null===(o=N.userNavLinks)||void 0===o?void 0:o[e]),setDirection:function(){h(e),C(N)}})};return(0,T.jsx)(Q.Z,{open:t,onClose:i,children:(0,T.jsx)(d.Z,{sx:le,children:v?(0,T.jsx)(O.Z,{size:50}):(0,T.jsxs)(d.Z,{children:[(0,T.jsx)(d.Z,{sx:{bgcolor:"white",mb:"10px",borderRadius:"10px",p:2},children:(0,T.jsx)(X,{room:N,direction:p,previousRoom:b})}),(0,T.jsxs)(d.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",bgcolor:"white",borderRadius:"10px",p:2},children:[P(ne),(0,T.jsxs)(d.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",alignItems:"center",justifyContent:"center"},children:[(0,T.jsx)(d.Z,{sx:{display:"flex"},children:P(te)}),(0,T.jsx)(d.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,T.jsx)(Z.Z,{sx:{color:A.palette.primary.main},children:(0,T.jsx)(ee.Z,{fontSize:"large"})})}),(0,T.jsx)(d.Z,{sx:{display:"flex"},children:P(re)})]}),P(ie)]})]})})})},de=t(61102),ue=t(14250),me=t(24177);function fe(){var e,n,t=(0,m.K)((function(e){return e.historyMessages})),i=(0,m.K)((function(e){return e.user})),o=(0,m.K)((function(e){return e.userChatRooms})),j=(0,m.K)((function(e){return e.loaderArchive})),w=(0,m.K)((function(e){return e.currentUntrackedChatRoom})),b=(0,r.useState)(),C=(0,c.Z)(b,2),I=C[0],D=C[1],A=(0,r.useState)(""),R=(0,c.Z)(A,2),L=R[0],M=R[1],P=(0,r.useState)(!0),J=(0,c.Z)(P,2),z=J[0],Y=J[1],$=(0,r.useState)(""),q=(0,c.Z)($,2),G=q[0],Q=q[1],X=(0,r.useMemo)((function(){return o.find((function(e){return e.jid===G}))}),[o,G]),ee=(0,r.useState)({jid:"",name:"",room_background:"",room_thumbnail:"",users_cnt:""}),ne=(0,c.Z)(ee,2),te=ne[0],ie=ne[1],re=(0,r.useRef)(null),oe=(0,_.Z)(),se=(0,F.Z)(oe.breakpoints.down("md")),ae=(0,r.useState)(!1),le=(0,c.Z)(ae,2),fe=le[0],pe=le[1],he=(0,r.useState)(!1),xe=(0,c.Z)(he,2),ge=xe[0],ve=xe[1],je=(0,r.useState)(!1),ye=(0,c.Z)(je,2),Ze=ye[0],we=ye[1],be=(0,r.useState)({headline:"",description:""}),Ce=(0,c.Z)(be,2),ke=Ce[0],Se=Ce[1],Ne=(0,y.UO)().roomJID,Ie=(0,y.k6)(),De=(0,r.useState)(!0),Ae=(0,c.Z)(De,2),Re=Ae[0],Le=Ae[1],Me=(0,m.K)((function(e){return e.activeRoomFilter})),Pe=(0,m.K)((function(e){return e.setActiveRoomFilter})),Je=Me===K.hx.meta,ze=(0,r.useCallback)((function(e){Oe(e[0])}),[te]),Ke=(0,V.uI)({onDrop:ze,noClick:!0,maxFiles:1}).getRootProps;(0,r.useEffect)((function(){Ne&&(_e(Ne),Y(!0))}),[Ne]),(0,r.useEffect)((function(){(0,f.k2)(i.walletAddress).then((function(e){D(e.data.result)}))}),[]);var Te,Ee,Ue=function(e){Ie.push("/chat/"+e.split("@")[0]),_e(e)},_e=function(e){Q(e);var n=o.filter((function(n){return n.jid===e}))[0];ie(n),m.K.getState().clearCounterChatRoom(e),m.K.getState().setCurrentUntrackedChatRoom(e);var i=t.filter((function(n){return n.roomJID===e}));if(Le(!0),!j&&i.length<=10&&i.length>0){var r=i[0].id;u.ZP.getPaginatedArchive(e,String(r),50)}},Fe=function(e){var n=t.filter((function(n){return n.roomJID===e})).slice(-1);return j&&n.length<=0?"Loading...":n.length>0?n[0].body:"No messages yet"},We=function(e){var n=t.filter((function(n){return n.roomJID===e})).slice(-1);return n.length<=0?"":(0,p.Z)(new Date(n[0].date),"H:mm")},Be=function(e){if(L.trim().length>0){var n="";null!==I&&void 0!==I&&I.profileImage&&(n=null===I||void 0===I?void 0:I.profileImage);var t=function(e){var n=e;return(0===(n=(n=(n=n.replace(/<br>/gi,"\n")).replace(/<p.*>/gi,"\n")).replace(/<(?:.|\s)*?>/g,"")).trim().length?(new DOMParser).parseFromString(e,"text/html"):(new DOMParser).parseFromString(n,"text/html")).body.textContent||""}(g.sanitize(L));t.trim().length>0&&u.ZP.sendMessage(G,i.firstName,i.lastName,n,i.walletAddress,"object"===typeof e?e.value:t,"object"===typeof e?e.notDisplayedValue:null)}},Oe=function(e){Se({headline:"File is loading, please wait...",description:""}),pe(!0);var n=new FormData;n.append("files",e),(0,f.cT)(n).then((function(e){var n="";null!==I&&void 0!==I&&I.profileImage&&(n=null===I||void 0===I?void 0:I.profileImage),e.data.results.map(function(){var e=(0,l.Z)((0,a.Z)().mark((function e(t){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r={firstName:i.firstName,lastName:i.lastName,walletAddress:i.walletAddress,chatName:te.name,userAvatar:n,createdAt:t.createdAt,expiresAt:t.expiresAt,fileName:t.filename,isVisible:t.isVisible,location:t.location,locationPreview:t.locationPreview,mimetype:t.mimetype,originalName:t.originalname,ownerKey:t.ownerKey,size:t.size,duration:null===t||void 0===t?void 0:t.duration,updatedAt:t.updatedAt,userId:t.userId,waveForm:"",attachmentId:t._id,wrappable:!0},u.ZP.sendMediaMessageStanza(G,r),pe(!1);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())})).catch((function(e){console.log(e),Se({headline:"Error",description:"An error occurred while uploading the file"}),ve(!0)})),re.current&&(re.current.value="")};return(0,r.useEffect)((function(){var e=setTimeout((function(){u.ZP.pausedComposing(i.walletAddress,te.jid)}),1e3);return function(){return clearTimeout(e)}}),[L]),(0,r.useEffect)((function(){w&&(Ne&&"none"!==Ne&&""!==Ne&&w.split("@")[0]!==Ne||(w.split("@")[1]?Ue(w):Ue(w+"@conference.dev.dxmpp.com"))),w.split("@")[0]!==Ne&&"none"!==Ne&&""!==Ne&&(m.K.getState().setCurrentUntrackedChatRoom(Ne),Ue(Ne)),window.onblur=function(){m.K.getState().setCurrentUntrackedChatRoom("")},window.onfocus=function(){G&&(m.K.getState().setCurrentUntrackedChatRoom(G),m.K.getState().clearCounterChatRoom(G))}}),[G]),(0,r.useEffect)((function(){var e=t.filter((function(e){return e.roomJID===G}));if(!j&&e.length>0&&e.length<=51&&G&&Re){var n=e[0];e.length>=10&&e.length<15&&n.data.isSystemMessage?(Le(!1),u.ZP.getPaginatedArchive(G,String(n.id),5)):1===e.length&&(Le(!1),u.ZP.getPaginatedArchive(G,String(n.id),50))}}),[t]),(0,T.jsxs)(d.Z,{style:{paddingBlock:"20px",height:"100%"},children:[(0,T.jsxs)(v.tz,{responsive:!0,children:[(0,T.jsxs)(v.YE,{position:"left",scrollable:!1,children:[(0,T.jsx)(v.ol,{placeholder:"Search..."}),(0,T.jsx)(v.p7,{loading:j,children:(Te=o,Ee=Me,Ee===K.hx.official||Ee===K.hx.favourite?Te.filter((function(e){return e.group===K.hx.official||e.group===K.hx.favourite})):Te.filter((function(e){return e.group!==K.hx.official&&e.group!==K.hx.favourite}))).map((function(e){return(0,T.jsx)(v.ri,{active:e.jid===G,unreadCnt:e.unreadMessages,onClick:function(){return Ue(e.jid)},name:e.name,info:Fe(e.jid),lastActivityTime:We(e.jid),children:(0,T.jsx)(v.qE,{src:"none"!==e.room_thumbnail?e.room_thumbnail:"https://icotar.com/initials/"+e.name})},e.jid)}))})]}),(0,T.jsx)("div",(0,s.Z)((0,s.Z)({},Ke()),{},{style:{width:"100%",height:"100%"},children:(0,T.jsxs)(v.uU,{children:[!!te&&(0,T.jsxs)(v.BU,{children:[(0,T.jsx)(v.BU.Back,{}),(0,T.jsx)(v.BU.Content,{userName:te.name,onClick:function(){Ie.push("/chatDetails/"+w)},info:t.filter((function(e){return e.roomJID===G})).length>0&&"Active "+(0,h.Z)((0,x.Z)(new Date(t.filter((function(e){return e.roomJID===G})).slice(-1)[0].date),0),new Date,{addSuffix:!0})}),(0,T.jsx)(v.BU.Actions,{children:(0,T.jsx)(Z.Z,{sx:{color:"black"},onClick:function(){return we(!0)},children:(0,T.jsx)(de.Z,{})})})]}),(0,T.jsxs)(v.rN,{style:{backgroundImage:null!==X&&void 0!==X&&X.room_background?"url(".concat(X.room_background,")"):"white",backgroundRepeat:"no-repeat",backgroundSize:"100% 100%"},loadingMore:j,onYReachStart:function(){var e=t.filter((function(e){return e.roomJID===G}));if(!j){var n=e[0].id;u.ZP.getPaginatedArchive(G,String(n),10)}},disableOnYReachWhenNoScroll:!0,typingIndicator:!(null===(e=o.filter((function(e){return e.jid===G}))[0])||void 0===e||!e.composing)&&(0,T.jsx)(v.c2,{style:{opacity:".6"},content:null===(n=o.filter((function(e){return e.jid===G}))[0])||void 0===n?void 0:n.composing}),children:[t.filter((function(e){return e.roomJID===G})).map((function(e,n,t){var i,r,o,s,a=function(e,n,t){var i,r,o,s,a,l,c,d=null===(i=e[t-1])||void 0===i||null===(r=i.data.senderJID)||void 0===r?void 0:r.split("/")[0],u=null===(o=e[t+1])||void 0===o||null===(s=o.data.senderJID)||void 0===s?void 0:s.split("/")[0],m=null===(a=n.data.senderJID)||void 0===a?void 0:a.split("/")[0],f={position:"single",type:"single"};return e[t-1]&&n&&(0,p.Z)(new Date(null===(c=e[t-1])||void 0===c?void 0:c.date),"dd")!==(0,p.Z)(new Date(n.date),"dd")&&(f.separator=(0,p.Z)(new Date(n.date),"EEEE, dd LLLL yyyy")),d!==m&&u!==m?f:d!==m&&u===m?(f.position="first",f.type="first",f):d===m&&u===m?(f.position="normal",f.type="normal",f):d===m&&u!==m&&"false"===(null===(l=e[t-1])||void 0===l?void 0:l.data.isSystemMessage)?(f.position="single",f.type="last",f):f}(t,e,n);return"false"===e.data.isSystemMessage?(0,T.jsx)(E,{is:"Message",position:a,message:e,userJid:null===(i=u.ZP.client)||void 0===i||null===(r=i.jid)||void 0===r?void 0:r.toString(),buttonSender:Be,chooseDirectRoom:Ue},e.id):(0,T.jsx)(U,{is:"Message",message:e,userJid:null===(o=u.ZP.client)||void 0===o||null===(s=o.jid)||void 0===s?void 0:s.toString()},e.id)})),t.length<=0||!G||"none@conference.dev.dxmpp.com"===G&&(0,T.jsx)(v.rN.Content,{style:{display:"flex",flexDirection:"column",justifyContent:"center",height:"100%",textAlign:"center",fontSize:"1.2em"},children:j?"Loading...":(0,T.jsx)("span",{children:G&&"none@conference.dev.dxmpp.com"!==G?null:"Choose a chat room or create one to start a conversation."})}),!j&&G&&"none@conference.dev.dxmpp.com"!==G&&t.filter((function(e){return e.roomJID===G})).length<=0&&(0,T.jsx)(v.rN.Content,{style:{display:"flex",flexDirection:"column",justifyContent:"center",height:"100%",textAlign:"center",fontSize:"1.2em"},children:"Message list is empty"})]}),!(null===te||void 0===te||!te.name)&&(0,T.jsxs)("div",{is:"MessageInput",children:[(0,T.jsx)(v.Ru,{onPaste:function(e){var n=Array.from(e.clipboardData.items).find((function(e){return/^image\//.test(e.type)}));if(n){var t=n.getAsFile();Oe(t)}},placeholder:"Type message here",onChange:function(e){M(e),u.ZP.isComposing(i.walletAddress,te.jid,i.firstName+" "+i.lastName)},onSend:Be,onAttachClick:function(){return re.current.click()}}),(0,T.jsx)("input",{type:"file",name:"file",id:"file",onChange:function(e){return Oe(e.target.files[0])},ref:re,style:{display:"none"}})]})]})}))]}),(0,T.jsxs)(S.Z,{fullScreen:se,open:fe,onClose:function(){return pe(!0)},"aria-labelledby":"responsive-dialog-title",children:[(0,T.jsx)(W.Z,{id:"responsive-dialog-title",children:ke.headline}),(0,T.jsx)(N.Z,{children:ge&&ke.description.length>0?(0,T.jsx)(B.Z,{children:ke.description}):(0,T.jsx)(d.Z,{sx:{display:"flex",justifyContent:"center"},children:(0,T.jsx)(O.Z,{})})}),ge?(0,T.jsx)(H.Z,{children:(0,T.jsx)(k.Z,{onClick:function(){return pe(!1)},autoFocus:!0,children:"Close"})}):null]}),(0,T.jsx)(ue.z,{open:Ze,link:(0,me.C$)({roomAddress:null===X||void 0===X?void 0:X.jid}),onClose:function(){we(!1)},title:"Share Chatroom"}),(0,T.jsx)(ce,{open:z||Je,chatId:G.split("@")[0],onClose:function(){Y(!1),Je&&Pe("")}})]})}function pe(){return(0,T.jsx)(o.Z,{maxWidth:"xl",style:{height:"calc(100vh - 68px)"},children:(0,T.jsx)(fe,{})})}},14250:function(e,n,t){t.d(n,{z:function(){return m}});t(72791);var i=t(60788),r=t(40464),o=t(17205),s=t(13811),a=t(52791),l=t(80925),c=t(24177),d=t(29823),u=t(80184),m=function(e){var n=e.title,t=e.open,m=e.link,f=e.onClose;return(0,u.jsxs)(i.Z,{maxWidth:!1,open:t,onClose:f,children:[!!n&&(0,u.jsx)(r.Z,{sx:{padding:"0 24px",paddingTop:"20px"},children:n}),(0,u.jsxs)(a.Z,{sx:{padding:"20px"},children:[(0,u.jsx)(l.Z,{size:256,style:{height:"50vh",maxWidth:"100%",width:"100%"},value:m,viewBox:"0 0 256 256"}),(0,u.jsxs)(a.Z,{sx:{boxShadow:"0px 0px 10px -5px rgba(0,0,0,0.75)",borderRadius:"10px",display:"flex",justifyContent:"space-between",alignItems:"center",pl:"10px",my:"10px"},children:[(0,u.jsx)("span",{children:(0,c.aS)(m,50)}),(0,u.jsx)(o.Z,{variant:"contained",sx:{borderRadius:"10px",marginLeft:"5px"},onClick:function(){return navigator.clipboard.writeText(m)},children:"Copy"})]}),(0,u.jsx)(s.Z,{onClick:f,sx:{color:"black",position:"absolute",top:10,right:10,fontSize:"30px"},children:(0,u.jsx)(d.Z,{fontSize:"inherit"})})]})]})}}}]);
//# sourceMappingURL=463.4f41c316.chunk.js.map