"use strict";(self.webpackChunkweb_app=self.webpackChunkweb_app||[]).push([[865],{66865:function(e,n,i){i.r(n),i.d(n,{default:function(){return H}});var t=i(72791),o=i(20803),r=i(74165),l=i(15861),a=i(70885),s=i(50228),d=i(13811),c=i(73978),u=i(4565),f=i(91803),h=i(59911),p=i(17205),x=i(64880),m=i(11210),j=i(85554),Z=i(41286),g=i(75426),v=i(60340),b=i(68438),y=i(27247),C=i(50705),w=i(50412),k=i(60788),S=i(77248),I=i(8440),R=i(39571),P=i(40464),D=i(96580),z=i(47409),L=i(80184);function M(e){var n=e.open,i=e.onClose,o=e.title,r=e.description,l=e.cancelButtonTitle,d=(0,x.UO)().roomJID,c=(0,t.useState)(""),u=(0,a.Z)(c,2),f=u[0],h=u[1],Z=(0,t.useState)(!1),g=(0,a.Z)(Z,2),v=g[0],b=g[1],y=(0,m.K)((function(e){return e.userChatRooms.find((function(e){return e.jid===d}))})),C=(0,t.useRef)(null);return(0,L.jsxs)(k.Z,{open:n,onClose:i,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,L.jsx)(P.Z,{id:"alert-dialog-title",children:o}),(0,L.jsxs)(I.Z,{children:[(0,L.jsx)(R.Z,{id:"alert-dialog-description",children:r}),(0,L.jsx)("input",{type:"file",name:"file",id:"file",onChange:function(e){return function(e){if(b(!0),h("Loading file, please wait..."),"image"===e.type.split("/")[0]){var n=new FormData;n.append("files",e),(0,z.cT)(n).then((function(e){var n=d.split("@")[0];j.ZP.setRoomImage(n,e.data.results[0].location,y.room_background,"icon");var i=Object.assign({},y);i.room_thumbnail=e.data.results[0].location,m.K.getState().updateUserChatRoom(i),h("Success! The chat icon was set."),b(!1)})).catch((function(e){console.log(e),h("An error occurred while loading the image.  ( "+e.message+" "+e.response.data+" )"),b(!1)}))}else h("You can only upload an image, please try again."),b(!1)}(e.target.files[0])},ref:C,style:{display:"none"}}),v?(0,L.jsx)(s.Z,{sx:{display:"flex",justifyContent:"center"},children:(0,L.jsx)(D.Z,{})}):null,(0,L.jsx)("p",{children:f})]}),(0,L.jsxs)(S.Z,{children:[(0,L.jsx)(p.Z,{variant:"contained",disabled:v,onClick:function(){return C.current.click()},autoFocus:!0,children:"Select and upload"}),(0,L.jsx)(p.Z,{disabled:v,onClick:i,children:l||"Cancel"})]})]})}function K(){var e,n=(0,x.UO)().roomJID,i=(0,t.useState)(""),k=(0,a.Z)(i,2),S=k[0],I=k[1],R=(0,t.useState)(""),P=(0,a.Z)(R,2),D=P[0],z=P[1],K=(0,t.useState)(!1),U=(0,a.Z)(K,2),A=U[0],J=U[1],O=(0,t.useState)(!1),T=(0,a.Z)(O,2),E=T[0],H=T[1],W=(0,t.useState)(!1),$=(0,a.Z)(W,2),N=$[0],V=$[1],q=(0,t.useState)(!1),B=(0,a.Z)(q,2),F=B[0],G=B[1],Y=(0,m.K)((function(e){return e.userChatRooms})).find((function(e){return(null===e||void 0===e?void 0:e.jid)===n})),Q=(0,m.K)((function(e){return e.roomRoles})),X=(0,x.k6)(),ee=null===(e=Q.find((function(e){return e.roomJID===(null===Y||void 0===Y?void 0:Y.jid)})))||void 0===e?void 0:e.role,ne=(0,m.K)((function(e){return e.updateChatRoomGroups})),ie=(0,m.K)((function(e){return e.userChatRoomGroups})).find((function(e){return(null===e||void 0===e?void 0:e.jid)===n})),te=ie&&(ie.group===b.hx.official||ie.group===b.hx.favourite),oe=function(e){var n={jid:Y.jid,group:e};ne(n)},re=function(){H(!1)},le=function(){var e=(0,l.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j.ZP.leaveTheRoom(n),j.ZP.unsubscribe(n),re(),X.push("/chat/none");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,L.jsxs)(o.Z,{style:{justifyContent:"center",alignItems:"center",display:"flex",flexDirection:"column"},children:[(0,L.jsx)("div",{style:{cursor:"pointer"},children:(0,L.jsxs)(s.Z,{sx:{width:200,height:200,margin:5,backgroundColor:"primary.dark",justifyContent:"center",alignItems:"center",display:"flex",borderRadius:"10px",position:"relative"},children:[(0,L.jsxs)(s.Z,{sx:{position:"absolute",top:0,right:0,display:"flex",flexDirection:"column",zIndex:99999},children:[(0,L.jsx)(d.Z,{sx:{color:"white"},onClick:function(){return oe(te?"":b.hx.official)},children:te?(0,L.jsx)(v.Z,{}):(0,L.jsx)(g.Z,{})}),(null===ie||void 0===ie?void 0:ie.group)!==b.hx.official&&(0,L.jsx)(d.Z,{sx:{color:"white"},onClick:function(){return V(!0)},children:(0,L.jsx)(C.Z,{})}),(null===ie||void 0===ie?void 0:ie.group)!==b.hx.official&&(0,L.jsx)(d.Z,{sx:{color:"red"},onClick:function(){return H(!0)},children:(0,L.jsx)(y.Z,{})})]}),(0,L.jsx)(d.Z,{disableRipple:!0,onClick:function(e){"moderator"!==ee&&"owner"!==ee&&"admin"!==ee||X.push("/changebg/"+n)},children:null!==Y&&void 0!==Y&&Y.room_thumbnail&&"none"!==(null===Y||void 0===Y?void 0:Y.room_thumbnail)?(0,L.jsx)(c.Z,{sx:{width:100,height:100},variant:"square",src:Y.room_thumbnail}):(0,L.jsx)(u.Z,{color:"white",fontSize:"120px",children:null===Y||void 0===Y?void 0:Y.name[0]})})]})}),(0,L.jsxs)(s.Z,{flexDirection:"row",display:"flex",children:[(0,L.jsx)(u.Z,{fontSize:"20px",fontWeight:"bold",children:null===Y||void 0===Y?void 0:Y.name}),(0,L.jsx)(d.Z,{onClick:function(){return G(!0)},style:{marginLeft:10},children:(0,L.jsx)(Z.Z,{fontSize:"small"})})]}),(0,L.jsxs)(o.Z,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center",display:"flex"},children:[(0,L.jsx)(u.Z,{fontSize:"20px",children:null!==Y&&void 0!==Y&&Y.description?Y.description:"No description"}),(0,L.jsx)(d.Z,{onClick:function(){return J(!0)},style:{marginLeft:10},children:(0,L.jsx)(Z.Z,{fontSize:"small"})})]}),(0,L.jsx)(f.Z,{open:A,onClose:function(){return J(!1)},"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,L.jsxs)(s.Z,{sx:_,children:[(0,L.jsx)(u.Z,{id:"modal-modal-title",variant:"h6",component:"h2",children:"Set new description"}),(0,L.jsx)(h.Z,{onChange:function(e){return I(e.target.value)},margin:"normal",id:"outlined-basic",label:"Description",variant:"outlined"}),(0,L.jsx)(p.Z,{onClick:function(){J(!1),function(e){j.ZP.changeRoomDescription(n,e)}(S)},style:{justifyContent:"center",alignItems:"center",display:"flex"},variant:"outlined",children:(0,L.jsx)(u.Z,{id:"modal-modal-description",children:"Submit"})})]})}),(0,L.jsx)(f.Z,{open:F,onClose:function(){return G(!1)},"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,L.jsxs)(s.Z,{sx:_,children:[(0,L.jsx)(u.Z,{id:"modal-modal-title",variant:"h6",component:"h2",children:"Set new room name"}),(0,L.jsx)(h.Z,{onChange:function(e){return z(e.target.value)},margin:"normal",id:"outlined-basic",label:"Room Name",variant:"outlined"}),(0,L.jsx)(p.Z,{onClick:function(){G(!1),function(e){j.ZP.changeRoomName(n,e)}(D)},style:{justifyContent:"center",alignItems:"center",display:"flex"},variant:"outlined",children:(0,L.jsx)(u.Z,{id:"modal-modal-description",children:"Submit"})})]})}),(0,L.jsx)(w.A,{open:E,title:"Delete",description:"Do you want to delete this room?",onDeletePress:le,onClose:re}),(0,L.jsx)(M,{open:N,title:"Change Image",description:"Choose a new image from your device",onClose:function(){return V(!1)}})]})}var _={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4,justifyContent:"center",flex:"display"},U=i(45629),A=i(76132),J=i(16992),O=i(70324),T=i(52898);function E(){var e,n=(0,x.UO)().roomJID,i=(0,m.K)((function(e){return e.userChatRooms})),o=(0,m.K)((function(e){return e.roomMemberInfo.filter((function(e){return"none"!==e.name}))})),r=(0,m.K)((function(e){return e.user})),l=i.find((function(e){return(null===e||void 0===e?void 0:e.jid)===n})),f=(0,t.useState)(!1),h=(0,a.Z)(f,2),p=h[0],Z=h[1],g=(0,t.useState)(),v=(0,a.Z)(g,2),b=(v[0],v[1]),y=(0,t.useState)(null),C=(0,a.Z)(y,2),w=C[0],k=C[1],S=(0,m.K)((function(e){return e.roomRoles})),I=(0,x.k6)(),R=null===(e=S.find((function(e){return e.roomJID===(null===l||void 0===l?void 0:l.jid)})))||void 0===e?void 0:e.role,P=function(e){e.stopPropagation(),k(null),Z(!1)};return(0,L.jsxs)(s.Z,{children:[(0,L.jsxs)(u.Z,{variant:"h5",children:["Members (",o.length,")"]}),(0,L.jsx)(U.Z,{sx:{width:"100%",bgcolor:"background.paper"},children:o.map((function(e){return(0,L.jsxs)(A.ZP,{dense:!0,onClick:function(){return function(e){e.jid.includes((0,j.$I)(r.walletAddress))?I.push("/profile/"+r.walletAddress):I.push("/profile/"+(0,j.$2)(e.jid.split("@")[0]))}(e)},style:{flexDirection:"row",alignItems:"center"},children:[(0,L.jsx)(s.Z,{alignItems:"center",justifyContent:"center",style:{background:"#003E9C",width:"40px",height:"40px",margin:5,display:"flex"},children:"none"!==e.profile?(0,L.jsx)(c.Z,{style:{width:"40px",height:"40px"},variant:"square",src:e.profile}):(0,L.jsx)(u.Z,{style:{color:"white"},children:e.name?e.name[0]:null})}),(0,L.jsx)(u.Z,{children:e.jid.includes((0,j.$I)(r.walletAddress))?"You":e.name}),!e.jid.includes((0,j.$I)(r.walletAddress))&&("moderator"===R||"owner"===R)&&(0,L.jsx)(d.Z,{"aria-label":"more",id:"long-button","aria-haspopup":"true",onClick:function(n){return function(e,n){e.stopPropagation(),b(n),k(e.currentTarget),Z(!0)}(n,e)},children:(0,L.jsx)(T.Z,{})}),"owner"===e.role&&(0,L.jsx)(s.Z,{style:{border:"1px solid",borderWidth:1,borderRadius:5,width:"70px",alignItems:"center",display:"flex",justifyContent:"center",marginLeft:10},children:(0,L.jsx)(u.Z,{children:e.role})}),"clear"!==e.ban_status?(0,L.jsx)(s.Z,{style:{border:"1px solid",borderWidth:1,borderRadius:5,width:"70px",alignItems:"center",display:"flex",justifyContent:"center",marginLeft:10},children:(0,L.jsx)(u.Z,{children:"banned"})}):null,(0,L.jsx)(J.Z,{id:"long-menu",MenuListProps:{"aria-labelledby":"long-button"},anchorEl:w,open:p,onClose:P,PaperProps:{style:{maxHeight:216,width:"20ch"}},children:(0,L.jsx)(O.Z,{onClick:function(n){return function(e,n){"clear"===e.ban_status?j.ZP.banUserStanza(e.jid,l.jid):j.ZP.unbanUserStanza(e.jid,l.jid),j.ZP.getRoomMemberInfo(l.jid),P(n)}(e,n)},children:"clear"===(null===e||void 0===e?void 0:e.ban_status)?"Ban":"Unban"})})]},e.jid)}))})]})}function H(){var e=(0,x.UO)().roomJID;return(0,t.useEffect)((function(){j.ZP.getRoomMemberInfo(e),j.ZP.getRoomInfo(e)}),[]),(0,L.jsxs)(o.Z,{maxWidth:"xl",children:[(0,L.jsx)(K,{}),(0,L.jsx)(E,{})]})}},41286:function(e,n,i){var t=i(64836);n.Z=void 0;var o=t(i(45649)),r=i(80184),l=(0,o.default)((0,r.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit");n.Z=l},50705:function(e,n,i){var t=i(64836);n.Z=void 0;var o=t(i(45649)),r=i(80184),l=(0,o.default)((0,r.jsx)("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"}),"InsertPhoto");n.Z=l},52898:function(e,n,i){var t=i(64836);n.Z=void 0;var o=t(i(45649)),r=i(80184),l=(0,o.default)((0,r.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVert");n.Z=l},75426:function(e,n,i){var t=i(64836);n.Z=void 0;var o=t(i(45649)),r=i(80184),l=(0,o.default)((0,r.jsx)("path",{d:"m12 8.89.94 3.11h2.82l-2.27 1.62.93 3.01L12 14.79l-2.42 1.84.93-3.01L8.24 12h2.82L12 8.89M12 2l-2.42 8H2l6.17 4.41L5.83 22 12 17.31 18.18 22l-2.35-7.59L22 10h-7.58L12 2z"}),"StarPurple500");n.Z=l}}]);
//# sourceMappingURL=865.71dbb2b2.chunk.js.map